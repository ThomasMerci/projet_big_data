(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","Slick","nf.Common","nf.UniversalCapture","nf.Dialog","nf.Storage","nf.Client","nf.ErrorHandler","nf.ProcessGroup","nf.ProcessGroupConfiguration","nf.Settings","nf.ParameterContexts","lodash"],function(i,f,g,k,h,j,o,l,c,d,e,m,n){b(i,f,g,k,h,j,o,l,c,d,e,m,n)})}else{if(typeof exports==="object"&&typeof module==="object"){b(require("jquery"),require("Slick"),require("nf.Common"),require("nf.UniversalCapture"),require("nf.Dialog"),require("nf.Storage"),require("nf.Client"),require("nf.ErrorHandler"),require("nf.ProcessGroup"),require("nf.ProcessGroupConfiguration"),require("nf.Settings"),require("nf.ParameterContexts"),require("lodash"))}else{b(a.$,a.Slick,a.nf.Common,a.nf.UniversalCapture,a.nf.Dialog,a.nf.Storage,a.nf.Client,a.nf.ErrorHandler,a.nf.ProcessGroup,a.nf.ProcessGroupConfiguration,a.nf.Settings,a.nf.ParameterContexts,a._)}}}(this,function(z,a,I,b,i,s,f,c,w,C,F,M,P){var K=null;var N=false;var v=null;var l=null;var h=212;var O=212;var H=100;var Q="<div>Expression Language (EL) supported</div>";var t='<div>After beginning with the start delimiter <span class="hint-pattern">${</span> use the keystroke <span class="hint-keystroke">control+space</span> to see a list of available functions.</div>';var n="<div>Expression Language (EL) not supported</div>";var e="<div>Parameters (PARAM) supported</div>";var k='<div>After beginning with the start delimiter <span class="hint-pattern">#{</span> use the keystroke <span class="hint-keystroke">control+space</span> to see a list of available parameters.</div>';var m="<div>Parameters (PARAM) not supported</div>";var o=function(R){if(I.isDefinedAndNotNull(R)){return R.startsWith("#{")&&R.endsWith("}")}return false};var x=function(S){var R=/#{[a-zA-Z0-9-_. ]+}/;return R.test(S)};var L=function(S,U){var V=z("<div></div>");var T=z("<div></div>").addClass("mode-hint-tip-title-container").appendTo(V);if(U){z("<div></div>").addClass("fa fa-check").appendTo(T);z(S?Q:e).addClass("mode-supported").appendTo(T);var R=z("<div></div>").addClass("mode-hint-tip-description-container").appendTo(V);z(S?t:k).appendTo(R)}else{z("<div></div>").addClass("fa fa-ban").appendTo(T);z(S?n:m).addClass("mode-unsupported").appendTo(T)}return V};var g=function(R){return function(X){var aa=this;var Z="";var T;var W;var U;var S;var V;var Y;this.init=function(){var ab=z("body");var af=z(X.grid.getContainerNode());var ao=af.data("descriptors");W=ao[X.item.property];var ag=R(W);var ai=I.isSensitiveProperty(W);T=X.item[X.column.field];S=z("<div></div>").addClass("slickgrid-nf-editor").css({"z-index":14000,position:"absolute",padding:"10px 20px",overflow:"hidden","border-radius":"2px","box-shadow":"rgba(0, 0, 0, 0.247059) 0px 2px 5px","background-color":"rgb(255, 255, 255)",cursor:"move",transform:"translate3d(0px, 0px, 0px)"}).draggable({cancel:".button, .mode-hint-element, .nf-editor, .string-check-container > *",containment:"parent"}).appendTo(ab);Y=z("<div></div>").addClass("mode-hint-tip").appendTo(ab);var ah=ag.supportsEl();var an=ag.supportsParameterReference();Y.append(L(true,ah));Y.append(L(false,an));var ae=z("<div></div>").addClass("mode-hint-container").appendTo(S);var aj=z("<div></div>").addClass("mode-hint-element").on("mouseenter",function(){var at=S.position();var ar=at.top-Y.outerHeight()+2;var aq=at.left+S.outerWidth()-Y.outerWidth()+5;Y.css({top:ar+"px",left:aq+"px"});Y.show()}).on("mouseleave",function(){Y.hide()}).appendTo(ae);var al=z("<div></div>").addClass("mode-hint").appendTo(aj);z("<div>EL</div>").appendTo(al);z("<div></div>").addClass("mode-hint-value fa").addClass(ah?"fa-check":"fa-ban").appendTo(al);var am=z("<div></div>").addClass("mode-hint").appendTo(aj);z("<div>PARAM</div>").appendTo(am);z("<div></div>").addClass("mode-hint-value fa").addClass(an?"fa-check":"fa-ban").appendTo(am);var ad=Math.max(X.position.width,O);V=z("<div></div>").addClass("nf-editor").appendTo(S).nfeditor({languageMode:ag,width:ad,minWidth:O,minHeight:H,resizable:true,sensitive:ai,escape:function(){aa.cancel()},enter:function(){aa.save()}});var ac=z('<div class="string-check-container" />');ac.appendTo(S);U=z('<div class="nf-checkbox string-check" />').on("change",function(ar,aq){if(aq.isChecked){V.nfeditor("setValue","");V.nfeditor("setReadOnly","nocursor")}else{V.nfeditor("setValue",Z);V.nfeditor("setReadOnly",false)}}).appendTo(ac);z('<span class="string-check-label nf-checkbox-label">&nbsp;Set empty string</span>').appendTo(ac);var ak=z('<div class="button">Ok</div>').css({color:"#fff",background:"#728E9B"}).hover(function(){z(this).css("background","#004849")},function(){z(this).css("background","#728E9B")}).on("click",aa.save);var ap=z('<div class="secondary-button">Cancel</div>').css({color:"#004849",background:"#E3E8EB"}).hover(function(){z(this).css("background","#C7D2D7")},function(){z(this).css("background","#E3E8EB")}).on("click",aa.cancel);z("<div></div>").css({position:"relative",top:"10px",left:"20px",width:"212px",clear:"both","float":"right"}).append(ak).append(ap).append('<div class="clear"></div>').appendTo(S);aa.position(X.position);V.nfeditor("focus").nfeditor("selectAll")};this.save=function(){X.commitChanges()};this.cancel=function(){V.nfeditor("setValue",Z);X.cancelChanges()};this.hide=function(){S.hide()};this.show=function(){S.show();V.nfeditor("refresh")};this.position=function(ab){S.css({top:ab.top-16,left:ab.left-42})};this.destroy=function(){V.nfeditor("destroy");S.remove();Y.remove()};this.focus=function(){V.nfeditor("focus")};this.loadValue=function(ad){var ae=false;var ab=I.isSensitiveProperty(W);if(I.isDefinedAndNotNull(ad[X.column.field])){if(ab){Z=I.config.sensitiveText}else{Z=ad[X.column.field];ae=Z===""}}var ac;if(ae){ac="checkbox-checked";V.nfeditor("setReadOnly","nocursor")}else{ac="checkbox-unchecked"}U.addClass(ac);V.nfeditor("setValue",Z).nfeditor("selectAll")};this.serializeValue=function(){var ab=V.nfeditor("getValue");if(ab===""){if(U.hasClass("checkbox-checked")){return""}if(I.isRequiredProperty(W)){if(I.isBlank(W.defaultValue)){return T}return W.defaultValue}return null}if(V.nfeditor("isModified")===false){return T}return ab};this.applyValue=function(ab,ac){ab[X.column.field]=ac};this.isValueChanged=function(){return aa.serializeValue()!==T};this.validate=function(){return{valid:true,msg:null}};this.init()}};var y=function(R,S){return function(ac){var af={text:"Reference parameter...",value:undefined,optionClass:"unset"};var X={text:"Loading parameters...",value:null,optionClass:"unset",disabled:true};var W={text:"Create new service...",value:"createControllerService",optionClass:"unset"};var ae=this;var V=[];var ag=[];var ad=null;var U;var Z;var ab;var aa;var T=true;var Y;this.init=function(){var ai=z("body");var al=z(ac.grid.getContainerNode());var aq=al.data("descriptors");aa=aq[ac.item.property];var at=al.closest(".property-container");var an=at.data("options");U=z('<div class="combo-editor"></div>').css({"z-index":1999,position:"absolute",padding:"10px 20px",overflow:"hidden","border-radius":"2px","box-shadow":"rgba(0, 0, 0, 0.247059) 0px 2px 5px","background-color":"rgb(255, 255, 255)",cursor:"move",transform:"translate3d(0px, 0px, 0px)"}).draggable({cancel:".button, .combo",containment:"parent"}).appendTo(ai);var ak=I.getAllowableValues(aa);if(z.isArray(ak)){z.each(ak,function(av,aw){var au=aw.allowableValue;V.push({text:au.displayName,value:au.value,disabled:aw.canRead===false&&au.value!==ac.item.previousValue,description:I.escapeHtml(au.description)})})}if(aa.required===false){V.push({text:"No value",value:null,optionClass:"unset"})}if(R){V.push(af)}if(V.length===0){V.push({text:"No value",value:null,optionClass:"unset",disabled:true})}if(I.isDefinedAndNotNull(aa.identifiesControllerService)){V.push(W)}var am=ac.position;var ah=z(window).height();var ap=ah-am.bottom-16;var aj=Math.max(am.width-16,h);Z=z('<div class="value-combo combo"></div>').combo({options:V,maxHeight:ap,select:function(au){var av=function(){ae.cancel();D(al,ac.grid,ac.item,aa.identifiesControllerService,aa.identifiesControllerServiceBundle,an)};if(R){if(I.isDefinedAndNotNull(ab)){if(au===af){ab.show()}else{ab.hide();if(au===W){av()}}}}else{if(au===W){av()}}}}).css({"margin-top":"10px","margin-bottom":"10px",width:aj+"px"}).appendTo(U);if(R){ab=z('<div class="value-combo combo"></div>').combo({options:[X],maxHeight:ap}).css({"margin-bottom":"10px",width:aj+"px"}).appendTo(U);Y=new z.Deferred(function(au){S(aa,function(av){var aw=P.sortBy(av,"name");aw.forEach(function(ax){ag.push({text:ax.name,value:"#{"+ax.name+"}",description:I.escapeHtml(ax.description)})});ab.combo("destroy").combo({options:ag,maxHeight:ap});au.resolve();T=false})}).promise()}var ar=z('<div class="secondary-button">Cancel</div>').css({color:"#004849",background:"#E3E8EB"}).hover(function(){z(this).css("background","#C7D2D7")},function(){z(this).css("background","#E3E8EB")}).on("click",ae.cancel);var ao=z('<div class="button">Ok</div>').css({color:"#fff",background:"#728E9B"}).hover(function(){z(this).css("background","#004849")},function(){z(this).css("background","#728E9B")}).on("click",ae.save);z("<div></div>").css({position:"relative",top:"10px",left:"20px",width:"212px","float":"right"}).append(ao).append(ar).appendTo(U);ae.position(am)};this.save=function(){ac.commitChanges()};this.cancel=function(){ac.cancelChanges()};this.hide=function(){U.hide()};this.show=function(){U.show()};this.position=function(ah){U.css({top:ah.top-24,left:ah.left-20})};this.destroy=function(){if(R){ab.combo("destroy")}Z.combo("destroy");U.remove();V.length=0;ag.length=0};this.focus=function(){};this.loadValue=function(ai){var aj;if(!I.isUndefined(ai.value)){aj=ai.value}else{if(I.isDefinedAndNotNull(aa.defaultValue)){aj=aa.defaultValue}}if(!I.isUndefined(aj)){ad=aj;var ah=V.find(function(al){return ad===al.value});if(!I.isUndefined(ah)){Z.combo("setSelectedOption",ah)}else{if(R&&o(ad)){Z.combo("setSelectedOption",af);var ak={value:ad};if(T){Y.then(function(){ab.combo("setSelectedOption",ak)})}else{ab.combo("setSelectedOption",ak)}}else{Z.combo("setSelectedOption",V[0])}}}else{Z.combo("setSelectedOption",V[0])}};this.serializeValue=function(){var ai=Z.combo("getSelectedOption");var ah=ai.value;if(R&&P.isUndefined(ah)){ai=ab.combo("getSelectedOption");if(ai===X){ah=ad}else{ah=ai.value}}return ah};this.applyValue=function(ah,ai){ah[ac.column.field]=ai};this.isValueChanged=function(){var ah=ae.serializeValue();return ah!==ad};this.validate=function(){return{valid:true,msg:null}};this.init()}};var G=function(af,ai,Y,R){b.removeAllPropertyDetailDialogs();var ae=af.getData();var Z=ae.getItem(Y);if(I.isDefinedAndNotNull(Z.value)){var aa=ai[Z.property];if(!I.isSensitiveProperty(aa)){var V=z(af.getCellNode(Y,R));var W=V.offset();var X=z('<div class="property-detail"></div>').css({"z-index":1999,position:"absolute",padding:"10px 20px",overflow:"hidden","border-radius":"2px","box-shadow":"rgba(0, 0, 0, 0.247059) 0px 2px 5px","background-color":"rgb(255, 255, 255)",cursor:"move",transform:"translate3d(0px, 0px, 0px)",top:W.top-24,left:W.left-20}).appendTo("body");var S=I.getAllowableValues(aa);if(z.isArray(S)){X.draggable({cancel:".button, .combo",containment:"parent"});var T=[];z.each(S,function(ak,al){var aj=al.allowableValue;T.push({text:aj.displayName,value:aj.value,description:I.escapeHtml(aj.description),disabled:true})});if(T.length===0){T.push({text:"No value",value:null,optionClass:"unset",disabled:true})}var ab=z(window).height();var ag=ab-(W.top+V.height())-16;var ah=V.width()-16;z('<div class="value-combo combo"></div>').css({width:ah,"margin-top":"10px","margin-bottom":"10px"}).combo({options:T,maxHeight:ag,selectedOption:{value:Z.value}}).appendTo(X);z('<div class="button">Ok</div>').css({position:"relative",top:"10px",left:"20px"}).hover(function(){z(this).css("background","#004849")},function(){z(this).css("background","#728E9B")}).on("click",function(){X.hide().remove()}).appendTo(X)}else{var U=null;if(I.supportsEl(aa)){X.css({"z-index":1999,position:"absolute",padding:"10px 20px",overflow:"hidden","border-radius":"2px","box-shadow":"rgba(0, 0, 0, 0.247059) 0px 2px 5px","background-color":"rgb(255, 255, 255)",cursor:"move",transform:"translate3d(0px, 0px, 0px)",top:W.top-22,left:W.left-43}).draggable({cancel:"input, textarea, pre, .button, .nf-editor",containment:"parent"});U=z("<div></div>").addClass("nf-editor").appendTo(X).nfeditor({languageMode:nf.nfel,width:V.width(),content:Z.value,minWidth:175,minHeight:100,readOnly:true,resizable:true,escape:function(){ad()}})}else{X.css({"z-index":1999,position:"absolute",padding:"10px 20px",overflow:"hidden","border-radius":"2px","box-shadow":"rgba(0, 0, 0, 0.247059) 0px 2px 5px","background-color":"rgb(255, 255, 255)",cursor:"move",transform:"translate3d(0px, 0px, 0px)",top:W.top-26,left:W.left-20});z('<textarea hidefocus rows="5" readonly="readonly" />').css({height:"80px",resize:"both",width:V.width()+"px",margin:"10px 0px","white-space":"pre"}).text(Z.value).on("keydown",function(aj){if(aj.which===z.ui.keyCode.ESCAPE){ad();aj.stopImmediatePropagation();aj.preventDefault()}}).appendTo(X);X.draggable({containment:"parent"})}var ad=function(){if(U!==null){U.nfeditor("destroy")}X.hide().remove()};var ac=z('<div class="button">Ok</div>').css({position:"relative",top:"10px",left:"20px"}).hover(function(){z(this).css("background","#004849")},function(){z(this).css("background","#728E9B")}).on("click",function(){ad()});z("<div></div>").append(ac).append('<div class="clear"></div>').appendTo(X)}}}};var D=function(R,T,U,V,S,W){z.ajax({type:"GET",url:"../nifi-api/flow/controller-service-types",data:{serviceType:V,serviceBundleGroup:S.group,serviceBundleArtifact:S.artifact,serviceBundleVersion:S.version},dataType:"json"}).done(function(Y){var ao=R.data("descriptors");var af=ao[U.property];var am=new Map();var ad=[];z.each(Y.controllerServiceTypes,function(ap,aq){am.set(ap,aq);ad.push({text:I.formatType(aq),value:ap,description:I.escapeHtml(aq.description)})});if(ad.length===0){i.showOkDialog({headerText:"Controller Service",dialogContent:"No controller service types found that are applicable for this property."})}else{var ak='<div id="new-inline-controller-service-dialog" class="hidden dialog medium-dialog cancellable"><div class="dialog-content"><div><div class="setting-name">Requires Controller Service</div><div class="setting-field"><div class="new-inline-controller-service-requirement"></div></div></div><div><div class="setting-name">Compatible Controller Services</div><div class="setting-field"><div class="new-inline-controller-service-combo"></div></div></div><div><div class="setting-name">Controller Service Name</div><div class="setting-field"><input type="text" class="new-inline-controller-service-name"/></div></div><div><div class="setting-name">Bundle</div><div class="setting-field"><div class="new-inline-controller-service-bundle"></div></div></div><div><div class="setting-name">Tags</div><div class="setting-field"><div class="new-inline-controller-service-tags"></div></div></div><div><div class="setting-name">Description</div><div class="setting-field"><div class="new-inline-controller-service-description"></div></div></div></div></div>';var aj=z(ak).appendTo(W.dialogContainer);var Z=aj.find("div.new-inline-controller-service-requirement");var ag=aj.find("div.new-inline-controller-service-combo");var an=aj.find("input.new-inline-controller-service-name");var ae=aj.find("div.new-inline-controller-service-bundle");var ab=aj.find("div.new-inline-controller-service-tags");var al=aj.find("div.new-inline-controller-service-description");var aa=I.formatType({type:af.identifiesControllerService,bundle:af.identifiesControllerServiceBundle});var ai=I.formatBundle(af.identifiesControllerServiceBundle);Z.text(aa+" from "+ai);ad.sort(function(aq,ap){var ar=am.get(aq.value);var av=am.get(ap.value);var au=I.substringAfterLast(ar.type,".");var at=I.substringAfterLast(av.type,".");return au===at?-I.sortVersion(ar.bundle.version,av.bundle.version):au>at?1:-1});var X=I.formatClassName(am.get(0));an.val(X);ag.combo({options:ad,select:function(aq){var ap=am.get(aq.value);ae.text(I.formatBundle(ap.bundle));ab.text(ap.tags.join(", "));al.text(ap.description);if(X===an.val().trim()){X=I.formatClassName(ap);an.val(X)}}});aj.modal({headerText:"Add Controller Service",scrollableContentStyle:"scrollable",buttons:[{buttonText:"Create",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){ah()}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){ac()}}}]});var ah=function(){var ar=ag.combo("getSelectedOption").value;var at=am.get(ar);var aq=an.val();var ap={revision:f.getRevision({revision:{version:0,}}),disconnectedNodeAcknowledged:s.isDisconnectionAcknowledged(),component:{type:at.type,bundle:at.bundle}};if(aq.trim()!==""){ap.component.name=aq.trim()}var au="../nifi-api/controller/controller-services";if(I.isDefinedAndNotNull(K)){au="../nifi-api/process-groups/"+encodeURIComponent(K)+"/controller-services"}z.ajax({type:"POST",url:au,data:JSON.stringify(ap),dataType:"json",contentType:"application/json"}).done(function(av){W.descriptorDeferred(U.property,false).done(function(az){var ay=az.propertyDescriptor;var aw=R.data("descriptors");if(!I.isUndefined(aw)){aw[ay.name]=ay}var ax=T.getData();ax.updateItem(U.id,z.extend(U,{value:av.component.id}));aj.modal("hide")});if(typeof W.controllerServiceCreatedDeferred==="function"){W.controllerServiceCreatedDeferred(av)}}).fail(c.handleAjaxError)};var ac=function(){aj.modal("hide")};aj.modal("show")}}).fail(c.handleAjaxError)};var r=function(aa,ab){var R=function(){var ac=aa.closest(".dialog");if(ac.hasClass("modal")){ac.modal("hide")}else{ac.hide()}};var X=function(al,aj,ai,af,ad){var ah=30;var ac=z("<div></div>");var ae=z("<span/>").addClass("table-cell").text(ai).appendTo(ac);if(ad.type==="required"){ae.addClass("required")}var ak=aa.data("descriptors");var ag=ak[ad.property];if(I.isDefinedAndNotNull(ag)){if(!I.isBlank(ag.description)||!I.isBlank(ag.defaultValue)||!I.isBlank(ag.supportsEl)){z('<div class="fa fa-question-circle" alt="Info" style="float: right;"></div>').appendTo(ac);z('<span class="hidden property-descriptor-name"></span>').text(ad.property).appendTo(ac);ah=46}}ae.width(af.width-ah).ellipsis();return ac.html()};var Y=function(ao,am,al,af,ac){var aj;var ai=0;if(I.isDefinedAndNotNull(al)){var an=aa.data("descriptors");var ah=an[ac.property];if(I.isSensitiveProperty(ah)){aj='<span class="table-cell sensitive">Sensitive value set</span>'}else{var ae=false;var ad=I.getAllowableValues(ah);if(z.isArray(ad)){z.each(ad,function(ap,ar){var aq=ar.allowableValue;if(al===aq.value){al=aq.displayName;ae=true;return false}})}if(al===""){aj='<span class="table-cell blank">Empty string set</span>'}else{ai=10;if(I.isMultiLine(al)){aj='<div class="table-cell value"><div class="ellipsis-white-space-pre multi-line-clamp-ellipsis">'+I.escapeHtml(al)+"</div></div>"}else{aj='<div class="table-cell value"><div class="ellipsis-white-space-pre">'+I.escapeHtml(al)+"</div></div>"}if(I.hasLeadTrailWhitespace(al)){aj+='<div class="fa fa-info" alt="Info" style="float: right;"></div>';ai=20}}}}else{aj='<span class="unset">No value set</span>'}var ag=z(aj);if(ac.type==="required"){ag.addClass("required")}var ak=ag.find(".ellipsis-white-space-pre");ak.attr("title",ak.text()).width(af.width-10-ai);return z("<div />").append(ag).html()};var S=[{id:"property",field:"displayName",name:"Property",sortable:false,resizable:true,rerenderOnResize:true,formatter:X},{id:"value",field:"value",name:"Value",sortable:false,resizable:true,cssClass:"pointer",rerenderOnResize:true,formatter:Y}];var W=function(aq,am,al,ag,ae){var ap="";var ao=aa.data("descriptors");var ai=ao[ae.property];var ad=I.isDefinedAndNotNull(ai.identifiesControllerService);var ac=I.isDefinedAndNotNull(ae.value);if(ad&&ac&&(ab.supportsGoTo===true)){z.each(ai.allowableValues,function(ar,au){var at=au.allowableValue;if(at.value===ae.value){ap+='<div class="pointer go-to-service fa fa-long-arrow-right" title="Go To"></div>';return false}})}var ah=x(ae.value);var an=false;var af=false;if(P.isFunction(ab.getParameterContext)){var ak=ab.getParameterContext(K);var aj=P.get(ak,"permissions.canWrite",false);af=P.get(ak,"permissions.canRead",false);an=aj&&af}if(ah&&af){ap+='<div title="Go to parameter" class="go-to-parameter pointer fa fa-long-arrow-right"></div>'}if(ab.readOnly!==true){if(an&&!ah){ap+='<div title="Convert to parameter" class="convert-to-parameter pointer fa fa-level-up"></div>'}if(ae.type==="userDefined"){ap+='<div title="Delete" class="delete-property pointer fa fa-trash"></div>'}}return ap};S.push({id:"actions",name:"&nbsp;",minWidth:20,width:20,formatter:W});var T={autosizeColsMode:a.GridAutosizeColsMode.LegacyForceFit,enableTextSelectionOnCells:true,enableCellNavigation:true,enableColumnReorder:false,editable:ab.readOnly!==true,enableAddRow:false,autoEdit:false,rowHeight:24};var Z=new a.Data.DataView({inlineFilters:false});Z.setItems([]);Z.setFilterArgs({searchString:"",property:"hidden"});Z.setFilter(B);Z.getItemMetadata=function(ad){var ag=Z.getItem(ad);var af=aa.data("descriptors");var ac=af[ag.property];var ai=function(ak,aj,al){aj(I.isSensitiveProperty(ak),K).done(function(am){l=am;al(am)})};var ae=typeof ab.parameterDeferred==="function";if(I.isUndefinedOrNull(ac)||I.supportsEl(ac)){return{columns:{value:{editor:g(function(aj){if(ae){nf.nfel.enableParameters();ai(aj,ab.parameterDeferred,nf.nfel.setParameters)}else{nf.nfel.disableParameters()}return nf.nfel})}}}}else{var ah=I.getAllowableValues(ac);if(z.isArray(ah)){return{columns:{value:{editor:y(ae,function(aj,ak){if(ae){ai(aj,ab.parameterDeferred,ak)}})}}}}else{return{columns:{value:{editor:g(function(aj){if(ae){nf.nfpr.enableParameters();ai(aj,ab.parameterDeferred,nf.nfpr.setParameters)}else{nf.nfpr.disableParameters()}return nf.nfpr})}}}}}};var V=function(ac){z.ajax({type:"GET",url:"../nifi-api/controller-services/"+encodeURIComponent(ac.value),dataType:"json",data:{uiOnly:true}}).done(function(ad){R();var ae=ad.component;z.Deferred(function(af){if(I.isDefinedAndNotNull(ae.parentGroupId)){w.enterGroup(ae.parentGroupId).done(function(){if(z("#process-group-configuration").is(":visible")){C.loadConfiguration(ae.parentGroupId).done(function(){af.resolve()})}else{C.showConfiguration(ae.parentGroupId).done(function(){af.resolve()})}})}else{if(z("#settings").is(":visible")){F.loadSettings().done(function(){af.resolve()})}else{F.showSettings().done(function(){af.resolve()})}}}).done(function(){if(I.isDefinedAndNotNull(ae.parentGroupId)){C.selectControllerService(ac.value)}else{F.selectControllerService(ac.value)}})}).fail(c.handleAjaxError)};var U=new a.Grid(aa,Z,S,T);U.setSelectionModel(new a.RowSelectionModel());U.onClick.subscribe(function(ag,ai){if(U.getColumns()[ai.cell].id==="value"){if(ab.readOnly===true){var am=aa.data("descriptors");G(U,am,ai.row,ai.cell)}else{U.gotoCell(ai.row,ai.cell,true)}ag.stopImmediatePropagation()}else{if(U.getColumns()[ai.cell].id==="actions"){var al=Z.getItem(ai.row);var ah=z(ag.target);if(ah.hasClass("delete-property")){Z.updateItem(al.id,z.extend(al,{hidden:true}));var am=aa.data("descriptors");delete am[al.property];ag.stopImmediatePropagation()}else{if(ah.hasClass("go-to-service")){if(ab.readOnly===true){V(al)}else{if(typeof ab.goToServiceDeferred==="function"){ab.goToServiceDeferred().done(function(){V(al)})}}}else{if(ah.hasClass("convert-to-parameter")){var ac;var an=false;if(P.isFunction(ab.getParameterContext)){ac=ab.getParameterContext(K);var aj=P.get(ac,"permissions.canWrite",false);var ad=P.get(ac,"permissions.canRead",false);an=aj&&ad}if(ab.readOnly!==true&&an){var am=aa.data("descriptors");var af=am[al.property];M.convertPropertyToParameter(al,af,ac.id).done(function(aq){var ap=P.extend({},al,{previousValue:al.value,value:"#{"+aq.name+"}"});Z.updateItem(al.id,ap)})}}else{if(ah.hasClass("go-to-parameter")){var ac;if(P.isFunction(ab.getParameterContext)){ac=ab.getParameterContext(K);var ad=P.get(ac,"permissions.canRead",false);if(ad&&!P.isNil(al.value)){var ae=/#{([a-zA-Z0-9-_. ]+)}/;var ao=al.value.match(ae);if(!P.isEmpty(ao)&&ao.length===2){R();var ak=ao[1];M.showParameterContext(ac.id,null,ak)}}}}}}}}}});U.onKeyDown.subscribe(function(ad,ac){if(ad.which===z.ui.keyCode.ESCAPE){var ae=U.getEditorLock();if(ae.isActive()){ae.cancelCurrentEdit();ad.stopImmediatePropagation();ad.preventDefault()}}});if(ab.readOnly!==true){U.onBeforeEditCell.subscribe(function(ad,ac){I.cleanUpTooltips(aa,"div.fa-question-circle, div.fa-info")});U.onBeforeCellEditorDestroy.subscribe(function(ad,ac){setTimeout(function(){var ag=U.getData();var af=aa.data("descriptors");var ae=ag.getItems();z.each(ae,function(al,ai){var ak=af[ai.property];var ah=false;if(!ak.dynamic){var aj=false;if(ak.dependencies.length>0){z.each(ak.dependencies,function(an,am){if(aj){return false}z.each(ae,function(ap,ar){if(ar.property===am.propertyName){ah=true;if(ar.hidden===false){var ao=ar.value;if(!P.isEmpty(l)){const aq=d(ao);if(aq.length>0){aq.forEach(function(at){ao=ao.replace("#{"+at.name+"}",I.isDefinedAndNotNull(at.value)?at.value:"")})}}if(ao){if(am.dependentValues){aj=!am.dependentValues.includes(ao)}else{aj=false}}else{aj=true}}else{aj=true}if(aj){return false}}})})}}else{aj=ai.hidden}ag.beginUpdate();ag.updateItem(al,z.extend(ai,{hidden:aj,dependent:ah}));ag.endUpdate();aj=false});U.resizeCanvas()},50)})}Z.onRowCountChanged.subscribe(function(ad,ac){U.updateRowCount();U.render()});Z.onRowsChanged.subscribe(function(ad,ac){U.invalidateRows(ac.rows);U.render()});aa.data("gridInstance",U).on("mouseenter","div.slick-cell",function(ae){var ai=z(this).find("div.fa-question-circle");if(ai.length&&!ai.data("qtip")){var aj=z(this).find("span.property-descriptor-name").text();var al=aa.data("descriptors");var ag=al[aj];var af=aa.data("history");var ah;if(af){ah=af[aj]}var ac=I.formatPropertyTooltip(ag,ah);if(I.isDefinedAndNotNull(ac)){ai.qtip(z.extend({},I.config.tooltipConfig,{content:ac}))}}var ak=z(this).find("div.fa-info");if(ak.length&&!ak.data("qtip")){var ad=I.formatWhitespaceTooltip();ak.qtip(z.extend({},I.config.tooltipConfig,{content:ad}))}})};var u=function(T){var S=T.data("gridInstance");if(I.isDefinedAndNotNull(S)){var R=S.getEditController();R.commitCurrentEdit()}};var p=function(U){var S={};var R=U.data("gridInstance");var T=R.getData();z.each(T.getItems(),function(){if(this.hidden===true&&!(this.dependent===true)){S[this.property]=null}else{if(this.value!==this.previousValue){S[this.property]=this.value}}});return S};var q=function(T){var R=[];var S=T.data("descriptors");z.each(S,function(){if(I.isSensitiveProperty(this)===true&&I.isDynamicProperty(this)===true){R.push(this.name)}});return R};var B=function(S,R){return S.hidden===false};var J=function(W,U,V,X,T){W.data({descriptors:V,history:X});if(P.isFunction(T.parameterDeferred)&&P.isFunction(T.getParameterContext)){var S=T.getParameterContext(K);var R=P.get(S,"permissions.canRead",false);if(R){T.parameterDeferred(false,K).done(function(Y){l=Y;j(W,U,V)});return}}j(W,U,V)};var j=function(W,T,U){var R=W.data("gridInstance");var V=R.getData();if(I.isDefinedAndNotNull(T)){V.beginUpdate();var S=0;z.each(T,function(Y,ac){var ad=U[Y];var aa="userDefined";var X=Y;if(I.isDefinedAndNotNull(ad)){if(I.isRequiredProperty(ad)){aa="required"}else{if(I.isDynamicProperty(ad)){aa="userDefined"}else{aa="optional"}}X=ad.displayName;if(I.isNull(ac)&&I.isDefinedAndNotNull(ad.defaultValue)){ac=ad.defaultValue}}var ab=false;var Z=false;if(ad.dependencies.length>0){z.each(ad.dependencies,function(ag,af){if(ab){return false}var ae=V.getItems();z.each(ae,function(ai,ak){if(ak.property===af.propertyName){Z=true;if(ak.hidden===false){var ah=ak.value;if(!P.isEmpty(l)){const aj=d(ah);if(aj.length>0){aj.forEach(function(al){ah=ah.replace("#{"+al.name+"}",I.isDefinedAndNotNull(al.value)?al.value:"")})}}if(ah){if(af.dependentValues){ab=!af.dependentValues.includes(ah)}else{ab=false}}else{ab=true}}else{ab=true}if(ab){return false}}})})}V.addItem({id:S++,hidden:ab,dependent:Z,property:Y,displayName:X,previousValue:ac,value:ac,type:aa});ab=false});V.endUpdate()}};var E=function(V){l=null;var S=V.data("options");if(S.readOnly===true){b.removeAllPropertyDetailDialogs()}else{if(I.isDefinedAndNotNull(S.dialogContainer)){z("#new-property-dialog").modal("hide")}}var U=V.find("div.property-table");U.removeData("descriptors history");I.cleanUpTooltips(U,"div.fa-question-circle, div.fa-info");var R=U.data("gridInstance");var T=R.getData();T.setItems([])};var d=function(U){if(P.isEmpty(l)){return[]}var W=[];if(!P.isNil(U)){var S=/#{(')?([a-zA-Z0-9-_. ]+)\1}/gm;var R;while((R=S.exec(U))!==null){if(R.index===S.lastIndex){S.lastIndex++}if(!P.isEmpty(R)&&R.length===3){const T=R[2];var V=l.find(function(X){return X.name===T});if(!P.isNil(V)){W.push(V)}}}}return W};var A={init:function(R){return this.each(function(){if(I.isDefinedAndNotNull(R)){var Y=z(this);Y.empty().unbind().addClass("property-container").data("options",R);var X=z('<div class="properties-header"></div>').appendTo(Y);z('<div class="required-property-note">Required field</div>').appendTo(X);var ae=z('<div class="property-table"></div>').appendTo(Y);if(R.readOnly!==true&&I.isDefinedAndNotNull(R.dialogContainer)){var V='<div id="new-property-dialog" class="dialog cancellable small-dialog hidden"><div class="dialog-content"><div class="setting"><div class="setting-name">Property name</div><div class="setting-field new-property-name-container"><input class="new-property-name" type="text"/></div></div><div class="setting"><div class="setting-name">Sensitive Value <span class="fa fa-question-circle" alt="Info" title="Components must declare support for Sensitive Dynamic Properties to enable selection of Sensitive Value status. Components that flag dynamic properties as sensitive do not allow Sensitive Value status to be changed."></span></div><div class="setting-field"><input id="value-sensitive-radio-button" type="radio" name="sensitive" value="sensitive" /> Yes<input id="value-not-sensitive-radio-button" type="radio" name="sensitive" value="plain" style="margin-left: 20px;"/> No</div></div></div></div>';var T=z(V).appendTo(R.dialogContainer);var W=T.find("input.new-property-name");var U=T.find("#value-sensitive-radio-button");var Z=T.find("#value-not-sensitive-radio-button");T.modal({headerText:"Add Property",buttons:[{buttonText:"Ok",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){ad()}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){ac()}}}]});var ad=function(){var ag=z.trim(W.val());if(ag!==""){var ah=ae.data("gridInstance");var aj=ah.getData();var ai=null;z.each(aj.getItems(),function(al,am){if(ag===am.property){ai=am;return false}});if(ai===null||ai.hidden===true){var af=U.prop("checked");R.descriptorDeferred(ag,af).done(function(al){var an=al.propertyDescriptor;var am=ae.data("descriptors");if(!I.isUndefined(am)){am[an.name]=an}if(ai===null){var ap=aj.getItems().length;aj.addItem({id:ap,hidden:false,property:ag,displayName:ag,previousValue:null,value:null,type:"userDefined"});var ao=aj.getRowById(ap);ah.setActiveCell(ao,ah.getColumnIndex("value"));ah.editActiveCell()}else{aj.updateItem(ai.id,z.extend(ai,{hidden:false,previousValue:null,value:null}));var ao=aj.getRowById(ai.id);ah.invalidateRow(ao);ah.render();ah.setActiveCell(ao,ah.getColumnIndex("value"));ah.editActiveCell()}})}else{i.showOkDialog({headerText:"Property Exists",dialogContent:"A property with this name already exists."});var ak=aj.getRowById(ai.id);ah.setSelectedRows([ak]);ah.scrollRowIntoView(ak)}}else{i.showOkDialog({headerText:"Property Name",dialogContent:"Property name must be specified."})}T.modal("hide")};var ac=function(){T.modal("hide")};W.on("keydown",function(ag){var af=ag.keyCode?ag.keyCode:ag.which;if(af===z.ui.keyCode.ENTER){ad();ag.stopImmediatePropagation();ag.preventDefault()}});T.on("click","div.new-property-ok",ad).on("click","div.new-property-cancel",ac);var aa=z('<div class="add-property" title="Add Property"></div>').appendTo(X);z('<button class="button fa fa-plus"></button>').on("click",function(){u(ae);W.val("");T.modal("show");W.focus();U.prop("checked",false);Z.prop("checked",true);var af=N!==true;U.prop("disabled",af);Z.prop("disabled",af)}).appendTo(aa);var S=z('<div class="verify-properties hidden" title="Verify Properties"></div>').appendTo(X);z('<button class="button fa fa-check-circle-o"></button>').on("click",function(){u(ae);v(p(ae))}).appendTo(S);v=R.propertyVerificationCallback;var ab=typeof v==="function";S.toggleClass("hidden",!ab)}z('<div class="clear"></div>').appendTo(X);r(ae,R)}})},loadProperties:function(S,T,U){var R=this;return R.each(function(){var X=z(this);var V=X.data("options");var W=X.find("div.property-table");J(W,S,T,U,V)})},saveRow:function(){return this.each(function(){var R=z(this).find("div.property-table");u(R)})},resetTableSize:function(){return this.each(function(){var S=z(this).find("div.property-table");var R=S.data("gridInstance");if(I.isDefinedAndNotNull(R)){R.resizeCanvas()}})},cancelEdit:function(){return this.each(function(){var T=z(this).find("div.property-table");var S=T.data("gridInstance");if(I.isDefinedAndNotNull(S)){var R=S.getEditController();R.cancelCurrentEdit()}})},destroy:function(){return this.each(function(){var S=z(this);var R=S.data("options");if(I.isDefinedAndNotNull(R)){E(S);if(I.isDefinedAndNotNull(R.dialogContainer)){z("#new-property-dialog").modal("hide");z(R.dialogContainer).children("div.new-inline-controller-service-dialog").remove()}}})},clear:function(){return this.each(function(){E(z(this))})},isSaveRequired:function(){var R=false;this.each(function(){var U=z(this).find("div.property-table");var S=U.data("gridInstance");var T=S.getData();z.each(T.getItems(),function(){if(this.value!==this.previousValue){R=true;return false}});return false});return R},marshalProperties:function(){var R={};this.each(function(){var S=z(this).find("div.property-table");R=p(S);return false});return R},getSensitiveDynamicPropertyNames:function(){var R=[];this.each(function(){var S=z(this).find("div.property-table");R=q(S);return false});return R},setGroupId:function(R){return this.each(function(){K=R})},setSupportsSensitiveDynamicProperties:function(R){return this.each(function(){N=R})},setPropertyVerificationCallback:function(R){return this.each(function(){v=R;var S=typeof R==="function";z(this).find("div.verify-properties").toggleClass("hidden",!S)})}};z.fn.propertytable=function(R){if(A[R]){return A[R].apply(this,Array.prototype.slice.call(arguments,1))}else{return A.init.apply(this,arguments)}}}));